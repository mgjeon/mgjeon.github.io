<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mingyu Jeon">
<meta name="dcterms.date" content="2025-08-06">

<title>Reproducing Figure 1 of the 2023 SunPy Paper in 2025 â€“ Mingyu Jeon</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W1ZRB9HZ0F"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-W1ZRB9HZ0F', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mingyu Jeon</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mgjeon"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Reproducing Figure 1 of the 2023 SunPy Paper in 2025</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">solar physics</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">english</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Mingyu Jeon </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#version-information" id="toc-version-information" class="nav-link active" data-scroll-target="#version-information">Version Information</a></li>
  <li><a href="#download-hmi-synoptic-magnetogram-for-cr-2255" id="toc-download-hmi-synoptic-magnetogram-for-cr-2255" class="nav-link" data-scroll-target="#download-hmi-synoptic-magnetogram-for-cr-2255">Download HMI Synoptic Magnetogram for CR 2255</a></li>
  <li><a href="#select-location-of-ar" id="toc-select-location-of-ar" class="nav-link" data-scroll-target="#select-location-of-ar">Select Location of AR</a></li>
  <li><a href="#download-euv-data-for-ar" id="toc-download-euv-data-for-ar" class="nav-link" data-scroll-target="#download-euv-data-for-ar">Download EUV data for AR</a></li>
  <li><a href="#process-euv-data-for-ar" id="toc-process-euv-data-for-ar" class="nav-link" data-scroll-target="#process-euv-data-for-ar">Process EUV Data for AR</a></li>
  <li><a href="#calculate-pfss-from-hmi-synoptic-magnetogram" id="toc-calculate-pfss-from-hmi-synoptic-magnetogram" class="nav-link" data-scroll-target="#calculate-pfss-from-hmi-synoptic-magnetogram">Calculate PFSS from HMI Synoptic Magnetogram</a></li>
  <li><a href="#trace-magnetic-field-lines" id="toc-trace-magnetic-field-lines" class="nav-link" data-scroll-target="#trace-magnetic-field-lines">Trace Magnetic Field Lines</a></li>
  <li><a href="#figure-1-from-the-sunpy-paper-2023" id="toc-figure-1-from-the-sunpy-paper-2023" class="nav-link" data-scroll-target="#figure-1-from-the-sunpy-paper-2023">Figure 1 from the SunPy Paper (2023)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div id="c4f961d6" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings<span class="op">;</span> warnings.simplefilter(<span class="st">"ignore"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging, sunpy<span class="op">;</span> logging.getLogger(<span class="st">'sunpy'</span>).setLevel(logging.ERROR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The SunPy <span class="citation" data-cites="sunpy_community2020">(<a href="#ref-sunpy_community2020" role="doc-biblioref">The SunPy Community et al. 2020</a>)</span> is a community-developed, free, and open source Python package for solar data analysis <span class="citation" data-cites="2015CS 2020JOSS 2023FrASS">(<a href="#ref-2023FrASS" role="doc-biblioref">Barnes et al. 2023</a>; <a href="#ref-2020JOSS" role="doc-biblioref">Mumford et al. 2020</a>; <a href="#ref-2015CS" role="doc-biblioref">The SunPy Community et al. 2015</a>)</span>.</p>
<p>In this post, I will reproduce Figure 1 (see below) of the 2023 SunPy paper <span class="citation" data-cites="2023FrASS">(<a href="#ref-2023FrASS" role="doc-biblioref">Barnes et al. 2023</a>)</span> using the SunPy ecosystem. This is because one of the most important affiliated packages, <code>pfsspy</code> <span class="citation" data-cites="2020JOSSpfss">(<a href="#ref-2020JOSSpfss" role="doc-biblioref">Stansby et al. 2020</a>)</span>, has been no longer developed since August 2023. The <code>pfsspy</code> package has been forked to <a href="https://github.com/sunpy/sunkit-magex"><code>sunkit-magex</code></a>. Also, there are subtle differences in the <code>aiapy</code> package between 2023 and 2025. Therefore, I will basically follow the steps in <a href="https://github.com/sunpy/sunpy-frontiers-paper/tree/main/figures">this code</a> provided by the authors of the 2023 SunPy paper, except that I will use the <code>sunkit-magex</code> package instead of the <code>pfsspy</code> package.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./fspas-10-1076726-g001.jpg" class="img-fluid figure-img"></p>
<figcaption>Figure 1 of the 2023 SunPy paper <a href="https://www.frontiersin.org/files/Articles/1076726/fspas-10-1076726-HTML-r1/image_m/fspas-10-1076726-g001.jpg">source</a></figcaption>
</figure>
</div>
<section id="version-information" class="level2">
<h2 class="anchored" data-anchor-id="version-information">Version Information</h2>
<div id="7d28245c" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Python version:"</span>, sys.version)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"NumPy version:"</span>, np.__version__)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matplotlib version:"</span>, matplotlib.__version__)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> astropy</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Astropy version:"</span>, astropy.__version__)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sunpy</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SunPy version:"</span>, sunpy.__version__)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aiapy</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"aiapy version:"</span>, aiapy.__version__)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sunpy_soar</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"sunpy-soar version:"</span>, sunpy_soar.__version__)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sunkit_magex</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"sunkit-magex version:"</span>, sunkit_magex.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Python version: 3.12.11 | packaged by conda-forge | (main, Jun  4 2025, 14:29:09) [MSC v.1943 64 bit (AMD64)]
NumPy version: 2.2.6
Matplotlib version: 3.10.5
Astropy version: 7.1.0
SunPy version: 7.0.1
aiapy version: 0.10.1
sunpy-soar version: 1.11.1
sunkit-magex version: 1.1.0</code></pre>
</div>
</div>
</section>
<section id="download-hmi-synoptic-magnetogram-for-cr-2255" class="level2">
<h2 class="anchored" data-anchor-id="download-hmi-synoptic-magnetogram-for-cr-2255">Download HMI Synoptic Magnetogram for CR 2255</h2>
<p>The SunPy paper (2023) said that the left panel of Figure1A shows the SDO/HMI synoptic magnetogram for Carrington rotation (CR) 2255 which began on 2022-03-08.</p>
<p>Letâ€™s start by checking that CR 2255 actually began on 2022-03-08.</p>
<div id="a15e17fd" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sunpy.coordinates.sun <span class="im">import</span> carrington_rotation_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4397ba32" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>carrington_rotation_time(<span class="dv">2255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Time object: scale='utc' format='iso' value=2022-03-07 11:59:56.657&gt;</code></pre>
</div>
</div>
<p>CR 2255 actually began on 2022-03-07 12:00 UTC, which also can be found in <a href="https://space.umd.edu/pm/crn/">this page</a>.</p>
<p>We can download the HMI polar-filled full-CR synoptic magnetogram <code>hmi.synoptic_mr_polfil_720s</code> <span class="citation" data-cites="sun2018">(<a href="#ref-sun2018" role="doc-biblioref">Sun 2018</a>)</span> for CR 2255 from JSOC using <code>sunpy.net.Fido</code>.</p>
<div id="348add98" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sunpy.net <span class="im">import</span> Fido, attrs <span class="im">as</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0b6d6e18" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please replace the following email with your own email address registered with the JSOC.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>jsoc_email <span class="op">=</span> <span class="st">'mgjeon@khu.ac.kr'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f8543c84" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> Fido.search(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    a.Time(<span class="st">'2022-03-07T12:00'</span>, <span class="st">'2022-03-07T12:00'</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    a.jsoc.Series(<span class="st">'hmi.synoptic_mr_polfil_720s'</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    a.jsoc.PrimeKey(<span class="st">'CAR_ROT'</span>, <span class="dv">2255</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    a.jsoc.Notify(jsoc_email)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="53909397" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
Results from 1 Provider:<br><br>1 Results from the JSOCClient:<br><div><i>JSOCResponse length=1</i>
<table id="table2648479056336" class="table-striped table-bordered table-condensed">
<thead><tr><th>TELESCOP</th><th>INSTRUME</th><th>WAVELNTH</th><th>CAR_ROT</th></tr></thead>
<thead><tr><th>str7</th><th>str9</th><th>float64</th><th>int64</th></tr></thead>
<tbody><tr><td>SDO/HMI</td><td>HMI_SIDE1</td><td>6173.0</td><td>2255</td></tr>
</tbody></table></div><br>
</div>
</div>
<div id="87a93644" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> Fido.fetch(q, path<span class="op">=</span><span class="st">'./data'</span>, overwrite<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="81f16983" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['data\\hmi.synoptic_mr_polfil_720s.2255.Mr_polfil.fits']</code></pre>
</div>
</div>
<p>We can load the fits file using <code>sunpy.map.Map</code>.</p>
<div id="7f1f16a9" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sunpy.<span class="bu">map</span> <span class="im">import</span> Map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1b97710b" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m_hmi <span class="op">=</span> Map(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5f917485" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m_hmi.peek()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This is the same HMI synoptic magnetogram as shown in the left panel of Figure 1A in the SunPy paper (2023).</p>
</section>
<section id="select-location-of-ar" class="level2">
<h2 class="anchored" data-anchor-id="select-location-of-ar">Select Location of AR</h2>
<p>We identify the center of the active region (AR) of interest visually from the HMI synoptic magnetogram.</p>
<div id="1d920098" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> astropy.units <span class="im">as</span> u</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.coordinates <span class="im">import</span> SkyCoord</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0cb546bf" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>m_hmi.coordinate_frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;HeliographicCarrington Frame (obstime=2022-03-21T03:51:33.000, rsun=695700.0 km, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-21T03:51:33.000, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;)&gt;</code></pre>
</div>
</div>
<div id="4c715a26" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ar_center <span class="op">=</span> SkyCoord(lon<span class="op">=</span><span class="dv">65</span><span class="op">*</span>u.deg, lat<span class="op">=</span><span class="dv">15</span><span class="op">*</span>u.deg, frame<span class="op">=</span>m_hmi.coordinate_frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can plot this coordinate on the HMI map.</p>
<div id="afc9a43f" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e4fbdc58" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span>m_hmi)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>m_hmi.plot(axes<span class="op">=</span>ax)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ax.plot_coord(ar_center, marker<span class="op">=</span><span class="st">'X'</span>, color<span class="op">=</span><span class="st">'k'</span>, markersize<span class="op">=</span><span class="dv">10</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The default obstime of the carrington map is halfway through the carrington rotation.</p>
<div id="fff20fc9" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_hmi.coordinate_frame.obstime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Time object: scale='utc' format='isot' value=2022-03-21T03:51:33.000&gt;</code></pre>
</div>
</div>
<div id="779747c3" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>car_start <span class="op">=</span> carrington_rotation_time(<span class="dv">2255</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>car_end <span class="op">=</span> carrington_rotation_time(<span class="dv">2256</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'CR 2255 start   '</span>, car_start)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'CR 2255 end     '</span>, car_end)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>car_halfway <span class="op">=</span> car_start <span class="op">+</span> (car_end <span class="op">-</span> car_start) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'CR 2255 halfway '</span>, car_halfway)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CR 2255 start    2022-03-07 11:59:56.657
CR 2255 end      2022-04-03 19:19:29.900
CR 2255 halfway  2022-03-21 03:39:43.279</code></pre>
</div>
</div>
<p>Since a synoptic map is comprised of observations from many different times, we look up the obstime associated with our selected longitude and use this to correct our original AR coordinate</p>
<div id="ecccd9b1" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ar_date <span class="op">=</span> carrington_rotation_time(<span class="dv">2255</span>, ar_center.lon)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ar_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Time object: scale='utc' format='iso' value=2022-03-29 21:04:15.174&gt;</code></pre>
</div>
</div>
<div id="98855b6e" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>change_obstime <span class="op">=</span> <span class="kw">lambda</span> x,y: SkyCoord(x.replicate(observer<span class="op">=</span>x.observer.replicate(obstime<span class="op">=</span>y), obstime<span class="op">=</span>y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e5522048" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ar_center_corrected <span class="op">=</span> change_obstime(ar_center, ar_date)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ar_center_corrected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;SkyCoord (HeliographicCarrington: obstime=2022-03-29 21:04:15.174, rsun=695700.0 km, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-29 21:04:15.174, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;): (lon, lat) in deg
    (65., 15.)&gt;</code></pre>
</div>
</div>
</section>
<section id="download-euv-data-for-ar" class="level2">
<h2 class="anchored" data-anchor-id="download-euv-data-for-ar">Download EUV data for AR</h2>
<p>We will download the EUV data from SDO/AIA, STEREO-A/SECCHI/EUVI, and Solar Orbiter/EUI/FSI.</p>
<p>First, we define the time range of interest.</p>
<div id="80724e56" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> a.Time(ar_date<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u.<span class="bu">min</span>, ar_date<span class="op">+</span><span class="dv">2</span><span class="op">*</span>u.<span class="bu">min</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;sunpy.net.attrs.Time(2022-03-29 21:02:15.174, 2022-03-29 21:06:15.174)&gt;</code></pre>
</div>
</div>
<p>We construct a search query for 171 Ã… EUV data from SDO/AIA and STEREO-A/SECCHI/EUVI. This will search the Virtual Solar Observatory (VSO).</p>
<div id="fc2c083b" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>aia_or_euvi <span class="op">=</span> ((a.Instrument(<span class="st">'AIA'</span>) <span class="op">|</span> a.Instrument(<span class="st">'EUVI'</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> a.Wavelength(<span class="dv">171</span><span class="op">*</span>u.angstrom)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> a.Sample(<span class="dv">5</span><span class="op">*</span>u.<span class="bu">min</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We construct a search query for 174 Ã… EUV data from Solar Orbiter/EUI/FSI. This will search the Solar Oriter Archive (SOAR) using the <code>sunpy-soar</code> package.</p>
<div id="3983d534" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>eui <span class="op">=</span> a.Level(<span class="dv">2</span>) <span class="op">&amp;</span> a.soar.Product(<span class="st">'EUI-FSI174-IMAGE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="99abcb5e" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> Fido.search(tr, aia_or_euvi <span class="op">|</span> eui)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="573bbd46" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
Results from 3 Providers:<br><br>1 Results from the VSOClient:<br><div><i>VSOQueryResponseTable length=1</i>
<table id="table2649631414112" class="table-striped table-bordered table-condensed">
<thead><tr><th>Start Time</th><th>End Time</th><th>Source</th><th>Instrument</th><th>Wavelength</th><th>Provider</th><th>Physobs</th><th>Wavetype</th><th>Extent Width</th><th>Extent Length</th><th>Extent Type</th><th>Size</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th>Angstrom</th><th></th><th></th><th></th><th></th><th></th><th></th><th>Mibyte</th></tr></thead>
<thead><tr><th>Time</th><th>Time</th><th>str3</th><th>str3</th><th>float64[2]</th><th>str4</th><th>str9</th><th>str6</th><th>str4</th><th>str4</th><th>str8</th><th>float64</th></tr></thead>
<tbody><tr><td>2022-03-29 21:02:21.000</td><td>2022-03-29 21:02:22.000</td><td>SDO</td><td>AIA</td><td>171.0 .. 171.0</td><td>JSOC</td><td>intensity</td><td>NARROW</td><td>4096</td><td>4096</td><td>FULLDISK</td><td>64.64844</td></tr>
</tbody></table></div><br>1 Results from the VSOClient:<br><div><i>VSOQueryResponseTable length=1</i>
<table id="table2649040858208" class="table-striped table-bordered table-condensed">
<thead><tr><th>Start Time</th><th>End Time</th><th>Source</th><th>Instrument</th><th>Wavelength</th><th>Provider</th><th>Physobs</th><th>Wavetype</th><th>Extent Type</th><th>Size</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th>Angstrom</th><th></th><th></th><th></th><th></th><th>Mibyte</th></tr></thead>
<thead><tr><th>Time</th><th>Time</th><th>str8</th><th>str6</th><th>float64[2]</th><th>str3</th><th>str9</th><th>str6</th><th>str8</th><th>float64</th></tr></thead>
<tbody><tr><td>2022-03-29 21:03:00.000</td><td>2022-03-29 21:03:02.000</td><td>STEREO_A</td><td>SECCHI</td><td>171.0 .. 175.0</td><td>SSC</td><td>intensity</td><td>NARROW</td><td>FULLDISK</td><td>-0.00098</td></tr>
</tbody></table></div><br>1 Results from the SOARClient:<br><div><i>QueryResponseTable length=1</i>
<table id="table2649631373744" class="table-striped table-bordered table-condensed">
<thead><tr><th>Instrument</th><th>Data product</th><th>Level</th><th>Start time</th><th>End time</th><th>Data item ID</th><th>Filename</th><th>Filesize</th><th>SOOP Name</th><th>Detector</th><th>Wavelength</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>Mbyte</th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>str3</th><th>str16</th><th>str2</th><th>str23</th><th>str23</th><th>str43</th><th>str52</th><th>float64</th><th>str31</th><th>str3</th><th>float64</th></tr></thead>
<tbody><tr><td>EUI</td><td>eui-fsi174-image</td><td>L2</td><td>2022-03-29 21:04:45.298</td><td>2022-03-29 21:04:55.298</td><td>solo_L2_eui-fsi174-image_20220329T210445298</td><td>solo_L2_eui-fsi174-image_20220329T210445298_V02.fits</td><td>5.593</td><td>L_FULL_HRES_HCAD_Eruption-Watch</td><td>FSI</td><td>174.0</td></tr>
</tbody></table></div><br>
</div>
</div>
<p>Note that <code>Fido</code> returns three results (one for each instrument) and that two out of the three of these are from the VSO and one is from the SOAR.</p>
<div id="40eca23e" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> Fido.fetch(q, path<span class="op">=</span><span class="st">'./data'</span>, overwrite<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9b50ccea" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">sorted</span>(files))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['data\\20220329_210300_n5euA.fts', 'data\\aia.lev1.171A_2022_03_29T21_02_21.35Z.image_lev1.fits', 'data\\solo_L2_eui-fsi174-image_20220329T210445298_V02.fits']</code></pre>
</div>
</div>
<div id="acc61e65" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m_secchi, m_aia, m_eui <span class="op">=</span> Map(<span class="bu">sorted</span>(files))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the metadata provided in each file, we can plot the relative locations of the three spacecraft.</p>
<div id="eea46e90" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'polar'</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Sun</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">20</span>, label<span class="op">=</span><span class="st">'Sun'</span>, color<span class="op">=</span><span class="st">'yellow'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the spacecraft locations</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> [m_aia, m_eui, m_secchi]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    sat <span class="op">=</span> m.observatory</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    coord <span class="op">=</span> m.observer_coordinate</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    ax.plot(coord.lon.to(<span class="st">'rad'</span>), coord.radius.to(u.AU), <span class="st">'o'</span>, label<span class="op">=</span>sat)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>ax.set_theta_zero_location(<span class="st">'S'</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="process-euv-data-for-ar" class="level2">
<h2 class="anchored" data-anchor-id="process-euv-data-for-ar">Process EUV Data for AR</h2>
<p>We prepare the SDO/AIA data <a href="https://aiapy.readthedocs.io/en/stable/preparing_data.html">from level 1 to level 1.5</a> using <code>aiapy</code> package by (1) correcting the pointing keywords and (2) also correcting the instrument degradation.</p>
<div id="354fadb6" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> aiapy.calibrate <span class="im">import</span> update_pointing, correct_degradation</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> aiapy.calibrate.util <span class="im">import</span> get_pointing_table, get_correction_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d9efdd58" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pointing_table <span class="op">=</span> get_pointing_table(<span class="st">'JSOC'</span>, time_range<span class="op">=</span>(m_aia.date<span class="op">-</span><span class="dv">12</span><span class="op">*</span>u.h, m_aia.date<span class="op">+</span><span class="dv">12</span><span class="op">*</span>u.h))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="574f5d16" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pointing_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><i>QTable length=8</i>
<table id="table2649631055488" class="table-striped table-bordered table-condensed">
<thead><tr><th>ORIGIN</th><th>TELESCOP</th><th>DATE</th><th>T_START</th><th>T_STOP</th><th>T_HKVALS</th><th>VERSION</th><th>SC_Y_INRT_BIAS</th><th>SC_Z_INRT_BIAS</th><th>H_CAM1_IMSCALE</th><th>H_CAM1_X0</th><th>H_CAM1_Y0</th><th>H_CAM1_INSTROT</th><th>H_CAM2_IMSCALE</th><th>H_CAM2_X0</th><th>H_CAM2_Y0</th><th>H_CAM2_INSTROT</th><th>A_094_IMSCALE</th><th>A_094_X0</th><th>A_094_Y0</th><th>A_094_INSTROT</th><th>A_131_IMSCALE</th><th>A_131_X0</th><th>A_131_Y0</th><th>A_131_INSTROT</th><th>A_171_IMSCALE</th><th>A_171_X0</th><th>A_171_Y0</th><th>A_171_INSTROT</th><th>A_193_IMSCALE</th><th>A_193_X0</th><th>A_193_Y0</th><th>A_193_INSTROT</th><th>A_211_IMSCALE</th><th>A_211_X0</th><th>A_211_Y0</th><th>A_211_INSTROT</th><th>A_304_IMSCALE</th><th>A_304_X0</th><th>A_304_Y0</th><th>A_304_INSTROT</th><th>A_335_IMSCALE</th><th>A_335_X0</th><th>A_335_Y0</th><th>A_335_INSTROT</th><th>A_1600_IMSCALE</th><th>A_1600_X0</th><th>A_1600_Y0</th><th>A_1600_INSTROT</th><th>A_1700_IMSCALE</th><th>A_1700_X0</th><th>A_1700_Y0</th><th>A_1700_INSTROT</th><th>A_4500_IMSCALE</th><th>A_4500_X0</th><th>A_4500_Y0</th><th>A_4500_INSTROT</th><th>HMI_FSW_AL1_POSITION</th><th>HAL1POS</th><th>HMI_FSW_AL2_POSITION</th><th>HAL2POS</th><th>HMI_AL1_STATUS</th><th>HAL1STAT</th><th>HMI_AL2_STATUS</th><th>HAL2STAT</th><th>HMI_ISS_ERRGAINY</th><th>HIERRGNY</th><th>HMI_ISS_ERRGAINZ</th><th>HIERRGNZ</th><th>HMI_ISS_ERROFFY</th><th>HIERROFY</th><th>HMI_ISS_ERROFFZ</th><th>HIERROFZ</th><th>HMI_ISS_PZTOFFA</th><th>HIPZTOFA</th><th>HMI_ISS_PZTOFFB</th><th>HIPZTOFB</th><th>HMI_ISS_PZTOFFC</th><th>HIPZTOFC</th><th>HMI_ISS_PKT_YCOEF_A</th><th>HIYCOEFA</th><th>HMI_ISS_PKT_YCOEF_B</th><th>HIYCOEFB</th><th>HMI_ISS_PKT_YCOEF_C</th><th>HIYCOEFC</th><th>HMI_ISS_PKT_ZCOEF_A</th><th>HIZCOEFA</th><th>HMI_ISS_PKT_ZCOEF_B</th><th>HIZCOEFB</th><th>HMI_ISS_PKT_ZCOEF_C</th><th>HIZCOEFC</th><th>AIA_IS1_ERRGAINY</th><th>A1ERRGNY</th><th>AIA_IS1_ERRGAINZ</th><th>A1ERRGNZ</th><th>AIA_IS1_ERROFFY</th><th>A1ERROFY</th><th>AIA_IS1_ERROFFZ</th><th>A1ERROFZ</th><th>AIA_IS1_PZTGAINA</th><th>A1PZTGNA</th><th>AIA_IS1_PZTGAINB</th><th>A1PZTGNB</th><th>AIA_IS1_PZTGAINC</th><th>A1PZTGNC</th><th>AIA_IS1_PZTOFFA</th><th>A1PZTOFA</th><th>AIA_IS1_PZTOFFB</th><th>A1PZTOFB</th><th>AIA_IS1_PZTOFFC</th><th>A1PZTOFC</th><th>AIA_GT1_PKT_YCOEF_A</th><th>AGT1_YCA</th><th>AIA_GT1_PKT_YCOEF_B</th><th>AGT1_YCB</th><th>AIA_GT1_PKT_YCOEF_C</th><th>AGT1_YCC</th><th>AIA_GT1_PKT_ZCOEF_A</th><th>AGT1_ZCA</th><th>AIA_GT1_PKT_ZCOEF_B</th><th>AGT1_ZCB</th><th>AIA_GT1_PKT_ZCOEF_C</th><th>AGT1_ZCC</th><th>AIA_IS2_ERRGAINY</th><th>A2ERRGNY</th><th>AIA_IS2_ERRGAINZ</th><th>A2ERRGNZ</th><th>AIA_IS2_ERROFFY</th><th>A2ERROFY</th><th>AIA_IS2_ERROFFZ</th><th>A2ERROFZ</th><th>AIA_IS2_PZTGAINA</th><th>A2PZTGNA</th><th>AIA_IS2_PZTGAINB</th><th>A2PZTGNB</th><th>AIA_IS2_PZTGAINC</th><th>A2PZTGNC</th><th>AIA_IS2_PZTOFFA</th><th>A2PZTOFA</th><th>AIA_IS2_PZTOFFB</th><th>A2PZTOFB</th><th>AIA_IS2_PZTOFFC</th><th>A2PZTOFC</th><th>AIA_GT2_PKT_YCOEF_A</th><th>AGT2_YCA</th><th>AIA_GT2_PKT_YCOEF_B</th><th>AGT2_YCB</th><th>AIA_GT2_PKT_YCOEF_C</th><th>AGT2_YCC</th><th>AIA_GT2_PKT_ZCOEF_A</th><th>AGT2_ZCA</th><th>AIA_GT2_PKT_ZCOEF_B</th><th>AGT2_ZCB</th><th>AIA_GT2_PKT_ZCOEF_C</th><th>AGT2_ZCC</th><th>AIA_IS3_ERRGAINY</th><th>A3ERRGNY</th><th>AIA_IS3_ERRGAINZ</th><th>A3ERRGNZ</th><th>AIA_IS3_ERROFFY</th><th>A3ERROFY</th><th>AIA_IS3_ERROFFZ</th><th>A3ERROFZ</th><th>AIA_IS3_PZTGAINA</th><th>A3PZTGNA</th><th>AIA_IS3_PZTGAINB</th><th>A3PZTGNB</th><th>AIA_IS3_PZTGAINC</th><th>A3PZTGNC</th><th>AIA_IS3_PZTOFFA</th><th>A3PZTOFA</th><th>AIA_IS3_PZTOFFB</th><th>A3PZTOFB</th><th>AIA_IS3_PZTOFFC</th><th>A3PZTOFC</th><th>AIA_GT3_PKT_YCOEF_A</th><th>AGT3_YCA</th><th>AIA_GT3_PKT_YCOEF_B</th><th>AGT3_YCB</th><th>AIA_GT3_PKT_YCOEF_C</th><th>AGT3_YCC</th><th>AIA_GT3_PKT_ZCOEF_A</th><th>AGT3_ZCA</th><th>AIA_GT3_PKT_ZCOEF_B</th><th>AGT3_ZCB</th><th>AIA_GT3_PKT_ZCOEF_C</th><th>AGT3_ZCC</th><th>AIA_IS4_ERRGAINY</th><th>A4ERRGNY</th><th>AIA_IS4_ERRGAINZ</th><th>A4ERRGNZ</th><th>AIA_IS4_ERROFFY</th><th>A4ERROFY</th><th>AIA_IS4_ERROFFZ</th><th>A4ERROFZ</th><th>AIA_IS4_PZTGAINA</th><th>A4PZTGNA</th><th>AIA_IS4_PZTGAINB</th><th>A4PZTGNB</th><th>AIA_IS4_PZTGAINC</th><th>A4PZTGNC</th><th>AIA_IS4_PZTOFFA</th><th>A4PZTOFA</th><th>AIA_IS4_PZTOFFB</th><th>A4PZTOFB</th><th>AIA_IS4_PZTOFFC</th><th>A4PZTOFC</th><th>AIA_GT4_PKT_YCOEF_A</th><th>AGT4_YCA</th><th>AIA_GT4_PKT_YCOEF_B</th><th>AGT4_YCB</th><th>AIA_GT4_PKT_YCOEF_C</th><th>AGT4_YCC</th><th>AIA_GT4_PKT_ZCOEF_A</th><th>AGT4_ZCA</th><th>AIA_GT4_PKT_ZCOEF_B</th><th>AGT4_ZCB</th><th>AIA_GT4_PKT_ZCOEF_C</th><th>AGT4_ZCC</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th>arcsec / pix</th><th>pix</th><th>pix</th><th>deg</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>str12</th><th>str3</th><th>str20</th><th>Time</th><th>Time</th><th>str20</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tbody><tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-30T16:51:58Z</td><td>2022-03-29T12:00:00.000</td><td>2022-03-29T18:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.821533</td><td>2009.129517</td><td>-0.13761</td><td>0.600698</td><td>2041.704346</td><td>2041.861694</td><td>-0.138795</td><td>0.599489</td><td>2054.610596</td><td>2047.310181</td><td>0.019327</td><td>0.600714</td><td>2040.759888</td><td>2041.918091</td><td>0.057789</td><td>0.600758</td><td>2036.590942</td><td>2040.456055</td><td>0.056433</td><td>0.600165</td><td>2067.379883</td><td>2006.143433</td><td>-0.131639</td><td>0.600737</td><td>2040.537598</td><td>2040.539795</td><td>-0.142443</td><td>0.609373</td><td>2051.854492</td><td>2046.561401</td><td>0.019792</td><td>0.612898</td><td>2053.222168</td><td>2044.922974</td><td>0.020525</td><td>0.599945</td><td>2051.936768</td><td>2048.193359</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-30T19:47:27Z</td><td>2022-03-29T15:00:00.000</td><td>2022-03-29T21:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.970459</td><td>2009.175171</td><td>-0.13761</td><td>0.600698</td><td>2041.645264</td><td>2041.656616</td><td>-0.138795</td><td>0.599489</td><td>2054.492676</td><td>2047.263306</td><td>0.019327</td><td>0.600714</td><td>2040.754395</td><td>2041.985474</td><td>0.057789</td><td>0.600758</td><td>2036.581665</td><td>2040.463379</td><td>0.056433</td><td>0.600165</td><td>2068.61377</td><td>2006.88269</td><td>-0.131639</td><td>0.600737</td><td>2040.461182</td><td>2040.399536</td><td>-0.142443</td><td>0.609373</td><td>2051.754395</td><td>2046.54126</td><td>0.019792</td><td>0.612898</td><td>2053.122559</td><td>2044.913208</td><td>0.020525</td><td>0.599945</td><td>2051.810059</td><td>2048.120117</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-30T22:07:31Z</td><td>2022-03-29T18:00:00.000</td><td>2022-03-30T00:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.912842</td><td>2009.273682</td><td>-0.13761</td><td>0.600698</td><td>2041.537964</td><td>2041.681763</td><td>-0.138795</td><td>0.599489</td><td>2054.495117</td><td>2047.277954</td><td>0.019327</td><td>0.600714</td><td>2040.449951</td><td>2042.01123</td><td>0.057789</td><td>0.600758</td><td>2036.267212</td><td>2040.533203</td><td>0.056433</td><td>0.600165</td><td>2067.975586</td><td>2006.063599</td><td>-0.131639</td><td>0.600737</td><td>2040.342285</td><td>2040.449707</td><td>-0.142443</td><td>0.609373</td><td>2051.721436</td><td>2046.502808</td><td>0.019792</td><td>0.612898</td><td>2053.067627</td><td>2044.884644</td><td>0.020525</td><td>0.599945</td><td>2054.710693</td><td>2067.672607</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-31T01:40:36Z</td><td>2022-03-29T21:00:00.000</td><td>2022-03-30T03:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.808594</td><td>2009.097412</td><td>-0.13761</td><td>0.600698</td><td>2041.29187</td><td>2041.739624</td><td>-0.138795</td><td>0.599489</td><td>2054.483643</td><td>2047.225342</td><td>0.019327</td><td>0.600714</td><td>2040.017334</td><td>2041.981079</td><td>0.057789</td><td>0.600758</td><td>2035.796387</td><td>2040.480957</td><td>0.056433</td><td>0.600165</td><td>2067.6875</td><td>2006.059692</td><td>-0.131639</td><td>0.600737</td><td>2040.373535</td><td>2040.357666</td><td>-0.142443</td><td>0.609373</td><td>2051.715088</td><td>2046.387817</td><td>0.019792</td><td>0.612898</td><td>2053.051025</td><td>2044.796875</td><td>0.020525</td><td>0.599945</td><td>2051.040039</td><td>2047.589966</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-31T04:51:55Z</td><td>2022-03-30T00:00:00.000</td><td>2022-03-30T06:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.527588</td><td>2009.48877</td><td>-0.13761</td><td>0.600698</td><td>2041.151978</td><td>2041.793945</td><td>-0.138795</td><td>0.599489</td><td>2054.188965</td><td>2047.548828</td><td>0.019327</td><td>0.600714</td><td>2039.276611</td><td>2042.256714</td><td>0.057789</td><td>0.600758</td><td>2033.271851</td><td>2040.747559</td><td>0.056433</td><td>0.600165</td><td>2068.605957</td><td>2007.465942</td><td>-0.131639</td><td>0.600737</td><td>2039.602539</td><td>2040.08252</td><td>-0.142443</td><td>0.609373</td><td>2051.780029</td><td>2046.560059</td><td>0.019792</td><td>0.612898</td><td>2052.833008</td><td>2044.995972</td><td>0.020525</td><td>0.599945</td><td>2051.76001</td><td>2048.25</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-31T07:53:59Z</td><td>2022-03-30T03:00:00.000</td><td>2022-03-30T09:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.494873</td><td>2009.120605</td><td>-0.13761</td><td>0.600698</td><td>2041.200684</td><td>2041.945679</td><td>-0.138795</td><td>0.599489</td><td>2054.434326</td><td>2047.566284</td><td>0.019327</td><td>0.600714</td><td>2039.73645</td><td>2042.167725</td><td>0.057789</td><td>0.600758</td><td>2035.616821</td><td>2040.686646</td><td>0.056433</td><td>0.600165</td><td>2067.87793</td><td>2006.530029</td><td>-0.131639</td><td>0.600737</td><td>2040.036011</td><td>2040.598633</td><td>-0.142443</td><td>0.609373</td><td>2051.646729</td><td>2046.790283</td><td>0.019792</td><td>0.612898</td><td>2053.012695</td><td>2045.160645</td><td>0.020525</td><td>0.599945</td><td>2050.919922</td><td>2047.823364</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-31T10:52:02Z</td><td>2022-03-30T06:00:00.000</td><td>2022-03-30T12:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.394287</td><td>2009.004272</td><td>-0.13761</td><td>0.600698</td><td>2041.256226</td><td>2041.89917</td><td>-0.138795</td><td>0.599489</td><td>2054.35498</td><td>2047.540771</td><td>0.019327</td><td>0.600714</td><td>2039.777466</td><td>2041.951416</td><td>0.057789</td><td>0.600758</td><td>2035.64502</td><td>2040.479126</td><td>0.056433</td><td>0.600165</td><td>2066.549072</td><td>2005.698975</td><td>-0.131639</td><td>0.600737</td><td>2040.107788</td><td>2040.618042</td><td>-0.142443</td><td>0.609373</td><td>2051.701416</td><td>2046.803101</td><td>0.019792</td><td>0.612898</td><td>2053.085449</td><td>2045.166504</td><td>0.020525</td><td>0.599945</td><td>2051.703369</td><td>2048.419922</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>SDO/JSOC-SDP</td><td>SDO</td><td>2022-03-31T13:41:38Z</td><td>2022-03-30T09:00:00.000</td><td>2022-03-30T15:00:00.000</td><td>2022-03-27T00:00:00Z</td><td>1</td><td>-4.983</td><td>9.323</td><td>0.50489</td><td>2033.790039</td><td>2051.580078</td><td>180.013504</td><td>0.50486</td><td>2039.630005</td><td>2048.47998</td><td>179.929794</td><td>0.600109</td><td>2069.457764</td><td>2008.996338</td><td>-0.13761</td><td>0.600698</td><td>2041.418945</td><td>2041.971558</td><td>-0.138795</td><td>0.599489</td><td>2054.505127</td><td>2047.432739</td><td>0.019327</td><td>0.600714</td><td>2039.960205</td><td>2041.846069</td><td>0.057789</td><td>0.600758</td><td>2035.748047</td><td>2040.355347</td><td>0.056433</td><td>0.600165</td><td>2067.651611</td><td>2006.154053</td><td>-0.131639</td><td>0.600737</td><td>2040.233398</td><td>2040.649048</td><td>-0.142443</td><td>0.609373</td><td>2051.861572</td><td>2046.778931</td><td>0.019792</td><td>0.612898</td><td>2053.227539</td><td>2045.158691</td><td>0.020525</td><td>0.599945</td><td>2051.843262</td><td>2048.419922</td><td>0.020638</td><td>76.0</td><td>76.0</td><td>44.0</td><td>44.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>81.0</td><td>-43.0</td><td>-43.0</td><td>-44.0</td><td>-44.0</td><td>-37.0</td><td>-37.0</td><td>66.0</td><td>66.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-16.0</td><td>-13.0</td><td>-13.0</td><td>-20920.0</td><td>-20920.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>-10460.0</td><td>0.0</td><td>0.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-15098.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-17.0</td><td>-17.0</td><td>53.0</td><td>53.0</td><td>-20.0</td><td>-20.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-19.0</td><td>-15.0</td><td>-15.0</td><td>-17.0</td><td>-17.0</td><td>32.0</td><td>32.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>-85.0</td><td>1.0</td><td>1.0</td><td>38.0</td><td>38.0</td><td>-18.0</td><td>-18.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>-30.0</td><td>11.0</td><td>11.0</td><td>5.0</td><td>5.0</td><td>-15.0</td><td>-15.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-79.0</td><td>-79.0</td><td>-78.0</td><td>-78.0</td><td>6.0</td><td>6.0</td><td>13.0</td><td>13.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-37.0</td><td>-37.0</td><td>9.0</td><td>9.0</td><td>29.0</td><td>29.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>-80.0</td><td>2.0</td><td>2.0</td><td>-6.0</td><td>-6.0</td><td>-15.0</td><td>-15.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>-22.0</td><td>25.0</td><td>25.0</td><td>1.0</td><td>1.0</td><td>-26.0</td><td>-26.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td><td>2048.0</td><td>2048.0</td><td>13900.0</td><td>13900.0</td><td>0.0</td><td>0.0</td></tr>
</tbody></table></div>
</div>
</div>
<div id="76afc7ca" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>correction_table <span class="op">=</span> get_correction_table(<span class="st">'JSOC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7e0772ae" class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>correction_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><i>QTable length=665</i>
<table id="table2649042359296" class="table-striped table-bordered table-condensed">
<thead><tr><th>DATE</th><th>VER_NUM</th><th>WAVE_STR</th><th>WAVELNTH</th><th>T_START</th><th>T_STOP</th><th>EFFA_P1</th><th>EFFA_P2</th><th>EFFA_P3</th><th>EFF_AREA</th><th>EFF_WVLN</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>Angstrom</th><th></th><th></th><th></th><th></th><th></th><th>cm2</th><th>Angstrom</th></tr></thead>
<thead><tr><th>str20</th><th>int64</th><th>str9</th><th>float64</th><th>Time</th><th>Time</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tbody><tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>-0.000383</td><td>0.0</td><td>0.0</td><td>0.101769</td><td>131.199997</td></tr>
<tr><td>2017-12-10T05:05:04Z</td><td>8</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>-0.000324</td><td>0.0</td><td>0.0</td><td>0.092281</td><td>131.199997</td></tr>
<tr><td>2020-07-06T21:54:29Z</td><td>9</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>-0.000377</td><td>0.0</td><td>0.0</td><td>0.101531</td><td>131.199997</td></tr>
<tr><td>2011-09-29T00:00:00Z</td><td>1</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2030-04-30T23:59:57.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.097468</td><td>131.199997</td></tr>
<tr><td>2012-01-05T00:00:00Z</td><td>2</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.075027</td><td>131.199997</td></tr>
<tr><td>2010-11-23T00:00:00Z</td><td>1</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-03-24T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.097</td><td>131.199997</td></tr>
<tr><td>2012-09-26T00:00:00Z</td><td>3</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.075027</td><td>131.199997</td></tr>
<tr><td>2011-04-29T00:00:00Z</td><td>1</td><td>131_THICK</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2012-01-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.097</td><td>131.199997</td></tr>
<tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>131_THIN</td><td>131.0</td><td>2010-03-24T00:00:00.000</td><td>2011-02-24T19:00:00.000</td><td>-0.000383</td><td>0.0</td><td>0.0</td><td>1.223503</td><td>131.199997</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>335_THICK</td><td>335.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.006929</td><td>335.399994</td></tr>
<tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>335_THIN</td><td>335.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.009789</td><td>335.399994</td></tr>
<tr><td>2020-07-06T21:54:47Z</td><td>9</td><td>335_THIN</td><td>335.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.009279</td><td>335.399994</td></tr>
<tr><td>2020-11-19T19:00:00Z</td><td>10</td><td>94_THICK</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.193237</td><td>93.900002</td></tr>
<tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>94_THICK</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.20261</td><td>93.900002</td></tr>
<tr><td>2020-07-06T21:54:28Z</td><td>9</td><td>94_THICK</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.213493</td><td>93.900002</td></tr>
<tr><td>2020-07-06T21:54:28Z</td><td>9</td><td>94_THIN</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.29744</td><td>93.900002</td></tr>
<tr><td>2020-11-19T19:00:00Z</td><td>10</td><td>94_THIN</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.26922</td><td>93.900002</td></tr>
<tr><td>2020-11-02T11:14:52Z</td><td>10</td><td>94_THIN</td><td>94.0</td><td>2020-06-01T12:00:00.000</td><td>2030-05-01T00:00:00.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.282278</td><td>93.900002</td></tr>
</tbody></table></div>
</div>
</div>
<div id="bc4a7952" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>m_aia.peek(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">8000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6b817ec9" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>m_aia <span class="op">=</span> correct_degradation(update_pointing(m_aia, pointing_table<span class="op">=</span>pointing_table), correction_table<span class="op">=</span>correction_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="57205f27" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>m_aia.peek(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">8000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The SDO/AIA and STEREO-A/SECCHI/EUVI data are not been normalized for exposure time, whereas the Solar Orbiter/EUI/FSI data (level 2) are normalized for exposure time.</p>
<div id="84101b6b" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m_secchi.peek()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b8aa385c" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m_eui.peek()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We normalize the SDO/AIA and STEREO-A/SECCHI/EUVI data for exposure time.</p>
<div id="61932a14" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m_aia <span class="op">=</span> m_aia <span class="op">/</span> m_aia.exposure_time</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m_secchi <span class="op">=</span> m_secchi <span class="op">/</span> m_secchi.exposure_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0ae4c06c" class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>m_aia.peek()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="5184e743" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>m_secchi.peek()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can plot the position of the corrected center of the AR on the EUV maps.</p>
<div id="dd1d816e" class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>([m_aia, m_eui, m_secchi]):</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>, projection<span class="op">=</span>m)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    m.plot(axes<span class="op">=</span>ax, clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    ax.plot_coord(ar_center_corrected, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'C3'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can plot the region of interest on the EUV maps.</p>
<div id="33e5df10" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ar_width <span class="op">=</span> <span class="dv">700</span><span class="op">*</span>u.arcsec</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ar_height <span class="op">=</span> <span class="dv">700</span><span class="op">*</span>u.arcsec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4febdce9" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>([m_aia, m_eui, m_secchi]):</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>, projection<span class="op">=</span>m)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    m.plot(axes<span class="op">=</span>ax, clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    ar_center_corrected_transformed <span class="op">=</span> ar_center_corrected.transform_to(m.coordinate_frame)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    blc <span class="op">=</span> SkyCoord(Tx<span class="op">=</span>ar_center_corrected_transformed.Tx<span class="op">-</span>ar_width<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                   Ty<span class="op">=</span>ar_center_corrected_transformed.Ty<span class="op">-</span>ar_height<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                   frame<span class="op">=</span>ar_center_corrected_transformed)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    m.draw_quadrangle(blc, width<span class="op">=</span>ar_width, height<span class="op">=</span>ar_height, edgecolor<span class="op">=</span><span class="st">'C3'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can rotate the maps such that the y-axis of the images is aligned with the solar north using <code>sunpy.map.Map.rotate</code>.</p>
<div id="d0cebab3" class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>([m_aia, m_eui, m_secchi]):</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>, projection<span class="op">=</span>m)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    m_rot <span class="op">=</span> m.rotate(missing<span class="op">=</span><span class="fl">0.0</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    m_rot.plot(axes<span class="op">=</span>ax, clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ar_center_corrected_transformed <span class="op">=</span> ar_center_corrected.transform_to(m_rot.coordinate_frame)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    blc <span class="op">=</span> SkyCoord(Tx<span class="op">=</span>ar_center_corrected_transformed.Tx<span class="op">-</span>ar_width<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                   Ty<span class="op">=</span>ar_center_corrected_transformed.Ty<span class="op">-</span>ar_height<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                   frame<span class="op">=</span>ar_center_corrected_transformed)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    m_rot.draw_quadrangle(blc, width<span class="op">=</span>ar_width, height<span class="op">=</span>ar_height, edgecolor<span class="op">=</span><span class="st">'C3'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can now crop each full disk image to the appropriate region.</p>
<div id="14bd74a6" class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m_cutouts <span class="op">=</span> []</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> [m_aia, m_eui, m_secchi]:</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    ar_center_corrected_transformed <span class="op">=</span> ar_center_corrected.transform_to(m.coordinate_frame)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    blc <span class="op">=</span> SkyCoord(Tx<span class="op">=</span>ar_center_corrected_transformed.Tx<span class="op">-</span>ar_width<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                   Ty<span class="op">=</span>ar_center_corrected_transformed.Ty<span class="op">-</span>ar_height<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                   frame<span class="op">=</span>ar_center_corrected_transformed)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Each map is rotated prior to submapping such that the selection is aligned with the coordinate grid</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    m_rot <span class="op">=</span> m.rotate(missing<span class="op">=</span><span class="fl">0.0</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    m_cutout <span class="op">=</span> m_rot.submap(blc, width<span class="op">=</span>ar_width, height<span class="op">=</span>ar_height)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    m_cutouts.append(m_cutout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e22549bb" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>(m_cutouts):</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>, projection<span class="op">=</span>m)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    m.plot(axes<span class="op">=</span>ax, clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculate-pfss-from-hmi-synoptic-magnetogram" class="level2">
<h2 class="anchored" data-anchor-id="calculate-pfss-from-hmi-synoptic-magnetogram">Calculate PFSS from HMI Synoptic Magnetogram</h2>
<p>We can calculate a potential field source surface (PFSS) solution from the HMI synoptic magnetogram using <code>sunkit-magex</code> package.</p>
<p>We first resample the HMI synoptic map to speed up the calculation of our field extrapolation.</p>
<div id="92d74fb5" class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>m_hmi.data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(1440, 3600)</code></pre>
</div>
</div>
<div id="53cb95eb" class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>m_hmi_resample <span class="op">=</span> m_hmi.resample((<span class="dv">1080</span>, <span class="dv">540</span>)<span class="op">*</span>u.pix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="31f7987c" class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>m_hmi_resample.data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(540, 1080)</code></pre>
</div>
</div>
<div id="784edb2b" class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sunkit_magex <span class="im">import</span> pfss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b011c8e8" class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>nr <span class="op">=</span> <span class="dv">70</span>    <span class="co"># number of cells in the radial direction</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> <span class="fl">2.5</span>  <span class="co"># radius of the source surface in R_sun</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>pfss_input <span class="op">=</span> pfss.Input(m_hmi_resample, nr, rss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1b544a3b" class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>pfss_output <span class="op">=</span> pfss.pfss(pfss_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Letâ€™s plot the radial component of the magnetic field at the source surface (2.5 Rs) and the polarity inversion lines (PILs).</p>
<div id="55deeee6" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span>pfss_output.source_surface_br)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> pfss_output.source_surface_br.plot(axes<span class="op">=</span>ax)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ax.plot_coord(pfss_output.source_surface_pils[<span class="dv">0</span>], color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im, ax<span class="op">=</span>ax)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-59-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="trace-magnetic-field-lines" class="level2">
<h2 class="anchored" data-anchor-id="trace-magnetic-field-lines">Trace Magnetic Field Lines</h2>
<p>Letâ€™s trace some field lines through the extrapolated field.</p>
<p>To do this, we need to choose a set of seed points from which to trace our field lines. We want to select only the seed points that are within a certain area around the active region. We need to make the following transformations because we want to express our boundaries in terms of the active region boundary as identified by our SDO/AIA cutout.</p>
<div id="29fcc1e6" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>change_obstime_frame <span class="op">=</span> <span class="kw">lambda</span> x,y: x.replicate_without_data(observer<span class="op">=</span>x.observer.replicate(obstime<span class="op">=</span>y), obstime<span class="op">=</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6c2240d1" class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>new_frame <span class="op">=</span> change_obstime_frame(m_hmi.coordinate_frame, m_cutouts[<span class="dv">0</span>].date)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>new_frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;HeliographicCarrington Frame (obstime=2022-03-29T21:02:21.350, rsun=695700.0 km, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-29T21:02:21.350, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;)&gt;</code></pre>
</div>
</div>
<div id="a162f929" class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>blc_ar_synop <span class="op">=</span> change_obstime(m_cutouts[<span class="dv">0</span>].bottom_left_coord.transform_to(new_frame),</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                              m_hmi.date)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>trc_ar_synop <span class="op">=</span> change_obstime(m_cutouts[<span class="dv">0</span>].top_right_coord.transform_to(new_frame),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                              m_hmi.date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We mask all those points that are above -10 G and fall outside of the bounding box defined above.</p>
<div id="b625b8b0" class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>masked_pix_y, masked_pix_x <span class="op">=</span> np.where(m_hmi_resample.data <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> m_hmi_resample.pixel_to_world(masked_pix_x<span class="op">*</span>u.pix, masked_pix_y<span class="op">*</span>u.pix).make_3d()</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>in_lon <span class="op">=</span> np.logical_and(seeds.lon <span class="op">&gt;</span> blc_ar_synop.lon, seeds.lon <span class="op">&lt;</span> trc_ar_synop.lon)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>in_lat <span class="op">=</span> np.logical_and(seeds.lat <span class="op">&gt;</span> blc_ar_synop.lat, seeds.lat <span class="op">&lt;</span> trc_ar_synop.lat)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> seeds[np.where(np.logical_and(in_lon, in_lat))]</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>seeds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;HeliographicCarrington Coordinate (obstime=2022-03-21T03:51:33.000, rsun=695700.0 km, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-21T03:51:33.000, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;): (lon, lat, radius) in (deg, deg, km)
    [(48.88333333, -5.63254256, 695700.),
     (69.55      , -5.63254256, 695700.),
     (74.88333333, -5.63254256, 695700.), ...,
     (62.55      , 41.38466759, 695700.),
     (63.88333333, 41.38466759, 695700.),
     (71.55      , 41.38466759, 695700.)]&gt;</code></pre>
</div>
</div>
<p>We can trace field lines from seeds specified above.</p>
<div id="cf3ece01" class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>max_steps <span class="op">=</span> <span class="bu">int</span>(np.ceil(<span class="dv">10</span> <span class="op">*</span> nr <span class="op">/</span> ds))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>tracer <span class="op">=</span> pfss.tracing.PerformanceTracer(step_size<span class="op">=</span>ds, max_steps<span class="op">=</span>max_steps)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fieldlines <span class="op">=</span> tracer.trace(SkyCoord(seeds), pfss_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also want to adjust obstime of all coordinates to coincide with AR at disk center. By default, each field line will have the obstime of the map that the field extrapolation was computed from. Additionally, we will choose only the close field lines.</p>
<div id="496dcb64" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fieldlines.closed_field_lines[<span class="dv">0</span>].coords.observer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-21T03:51:33.000, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;</code></pre>
</div>
</div>
<div id="d3034ce4" class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>fline_coords <span class="op">=</span> [change_obstime(f.coords, m_aia.date) <span class="cf">for</span> f <span class="kw">in</span> fieldlines.closed_field_lines <span class="cf">if</span> f.coords.shape[<span class="dv">0</span>]<span class="op">&gt;</span><span class="dv">500</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="189a3c05" class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(fline_coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1762</code></pre>
</div>
</div>
<div id="c0ed17bc" class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fline_coords[<span class="dv">0</span>].observer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;HeliographicStonyhurst Coordinate (obstime=2022-03-29T21:02:21.350, rsun=695700.0 km): (lon, lat, radius) in (deg, deg, m)
    (0., -7.02110576, 1.48994814e+11)&gt;</code></pre>
</div>
</div>
<p>Finally, letâ€™s plot these field lines on top of our EUV images.</p>
<div id="f8a32806" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">5</span>))</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>(m_cutouts):</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>, projection<span class="op">=</span>m)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    m.plot(axes<span class="op">=</span>ax, title<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>m<span class="sc">.</span>observatory<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>m<span class="sc">.</span>detector<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>m<span class="sc">.</span>wavelength<span class="sc">.</span>to_string(<span class="bu">format</span><span class="op">=</span><span class="st">"latex"</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    bounds <span class="op">=</span> ax.axis()</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> fline_coords[::<span class="dv">5</span>]:</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>        ax.plot_coord(c, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'C2'</span>, alpha<span class="op">=</span><span class="fl">0.75</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    ax.axis(bounds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-69-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-1-from-the-sunpy-paper-2023" class="level2">
<h2 class="anchored" data-anchor-id="figure-1-from-the-sunpy-paper-2023">Figure 1 from the SunPy Paper (2023)</h2>
<p>We can plot Figure 1 from the SunPy paper (2023).</p>
<div id="e3604b65" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> ConnectionPatch</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.gridspec <span class="im">import</span> GridSpec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b69fc56b" class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_connectors(ax1, ax2, p1, p2, color<span class="op">=</span><span class="st">'k'</span>, lw<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    con1 <span class="op">=</span> ConnectionPatch(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">0</span>, <span class="dv">1</span>), ax1.wcs.world_to_pixel(p1), <span class="st">'axes fraction'</span>, <span class="st">'data'</span>, axesA<span class="op">=</span>ax2, axesB<span class="op">=</span>ax1,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>        arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span>color, lw<span class="op">=</span>lw</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    con2 <span class="op">=</span> ConnectionPatch(</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">1</span>, <span class="dv">1</span>), ax1.wcs.world_to_pixel(p2), <span class="st">'axes fraction'</span>, <span class="st">'data'</span>, axesA<span class="op">=</span>ax2, axesB<span class="op">=</span>ax1,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span>color, lw<span class="op">=</span>lw</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    ax2.add_artist(con1)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    ax2.add_artist(con2)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>h_w_ratio <span class="op">=</span> <span class="dv">21</span> <span class="op">/</span> <span class="dv">18</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>frame_color <span class="op">=</span> <span class="st">'C3'</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(width, width<span class="op">*</span>h_w_ratio))</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> GridSpec(<span class="dv">3</span>, <span class="dv">3</span>, figure<span class="op">=</span>fig)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot HMI synoptic map</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, :<span class="dv">2</span>], projection<span class="op">=</span>m_hmi)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>m_hmi.plot(axes<span class="op">=</span>ax, title<span class="op">=</span><span class="st">'HMI Synoptic Magnetogram (CR 2255)'</span>)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>m_hmi.draw_quadrangle(blc_ar_synop, top_right<span class="op">=</span>trc_ar_synop, color<span class="op">=</span>frame_color)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>ax.coords[<span class="dv">0</span>].grid(color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>ax.coords[<span class="dv">1</span>].grid(color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot spacecraft locations</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">2</span>], projection<span class="op">=</span><span class="st">'polar'</span>)</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">15</span>, label<span class="op">=</span><span class="st">'Sun'</span>, color<span class="op">=</span><span class="st">'yellow'</span>)</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> m_cutouts:</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    sat <span class="op">=</span> m.observatory</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>    coord <span class="op">=</span> m.observer_coordinate</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    ax.plot(coord.lon.to(<span class="st">'rad'</span>), coord.radius.to(u.AU), <span class="st">'o'</span>, label<span class="op">=</span>sat)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    ax.text(coord.lon.to_value(<span class="st">'rad'</span>)<span class="op">*</span><span class="fl">1.15</span>, coord.radius.to_value(u.AU)<span class="op">*</span><span class="fl">0.95</span>, sat)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>ax.set_theta_zero_location(<span class="st">'S'</span>)</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>ax.set_rlabel_position(<span class="dv">225</span>)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>ax.set_rlim(<span class="dv">0</span>, <span class="fl">1.1</span>)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot full-disk EUV images</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>full_disk_axes <span class="op">=</span> []</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>([m_aia, m_eui, m_secchi]):</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, i], projection<span class="op">=</span>m)</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>    m.plot(axes<span class="op">=</span>ax, clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent, title<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>m<span class="sc">.</span>observatory<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>m<span class="sc">.</span>detector<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>m<span class="sc">.</span>wavelength<span class="sc">.</span>to_string(<span class="bu">format</span><span class="op">=</span><span class="st">"latex"</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>    m.draw_quadrangle(m_cutouts[i].bottom_left_coord, top_right<span class="op">=</span>m_cutouts[i].top_right_coord, color<span class="op">=</span>frame_color, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i:</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>        ax.coords[<span class="dv">1</span>].set_axislabel(<span class="st">' '</span>)</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">0</span>].set_axislabel(<span class="st">' '</span>)</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>    full_disk_axes.append(ax)</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">1</span>].set_ticklabel(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot EUV cutouts with field lines</span></span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>(m_cutouts):</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, i], projection<span class="op">=</span>m)</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    m.plot(</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>        axes<span class="op">=</span>ax,</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>        clip_interval<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">99.99</span>)<span class="op">*</span>u.percent,</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>    bounds <span class="op">=</span> ax.axis()</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> fline_coords[::<span class="dv">8</span>]:</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>        ax.plot_coord(c, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'C2'</span>, alpha<span class="op">=</span><span class="fl">0.75</span>)</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>    ax.axis(bounds)</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i:</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>        ax.coords[<span class="dv">1</span>].set_axislabel(<span class="st">' '</span>)</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>    bottom_right <span class="op">=</span> SkyCoord(Tx<span class="op">=</span>m_cutouts[i].top_right_coord.Tx, Ty<span class="op">=</span>m_cutouts[i].bottom_left_coord.Ty, frame<span class="op">=</span>m_cutouts[i].coordinate_frame)</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>    add_connectors(full_disk_axes[i], ax, m_cutouts[i].bottom_left_coord, bottom_right, color<span class="op">=</span>frame_color, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>    ax.grid(alpha<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">0</span>].set_ticks(direction<span class="op">=</span><span class="st">'in'</span>, color<span class="op">=</span>frame_color)</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">1</span>].set_ticks(direction<span class="op">=</span><span class="st">'in'</span>, color<span class="op">=</span>frame_color)</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">0</span>].frame.set_color(frame_color)</span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">0</span>].frame.set_linewidth(<span class="dv">1</span>)</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">1</span>].frame.set_color(frame_color)</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">1</span>].frame.set_linewidth(<span class="dv">1</span>)</span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>    ax.coords[<span class="dv">1</span>].set_ticklabel(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.0</span>)</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-71-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-2023FrASS" class="csl-entry" role="listitem">
Barnes, W. T., Christe, S., Freij, N., et al. 2023, Frontiers in Astronomy and Space Sciences, 10, 1076726, <a href="https://arxiv.org/abs/2304.09794">https://arxiv.org/abs/2304.09794</a>
</div>
<div id="ref-2020JOSS" class="csl-entry" role="listitem">
<a href="https://doi.org/10.21105/joss.01832">Mumford, S., Freij, N., Christe, S., et al. 2020, The Journal of Open Source Software, 5, 1832</a>
</div>
<div id="ref-2020JOSSpfss" class="csl-entry" role="listitem">
<a href="https://doi.org/10.21105/joss.02732">Stansby, D., Yeates, A., &amp; Badman, S. 2020, The Journal of Open Source Software, 5, 2732</a>
</div>
<div id="ref-sun2018" class="csl-entry" role="listitem">
Sun, X. 2018, <a href="https://arxiv.org/abs/1801.04265">https://arxiv.org/abs/1801.04265</a>
</div>
<div id="ref-sunpy_community2020" class="csl-entry" role="listitem">
The SunPy Community, Barnes, W. T., Bobra, M. G., et al. 2020, The Astrophysical Journal, 890 (American Astronomical Society), 68, <a href="https://iopscience.iop.org/article/10.3847/1538-4357/ab4f7a">https://iopscience.iop.org/article/10.3847/1538-4357/ab4f7a</a>
</div>
<div id="ref-2015CS" class="csl-entry" role="listitem">
The SunPy Community, Mumford, S. J., Christe, S., et al. 2015, Computational Science and Discovery, 8, 014009, <a href="https://arxiv.org/abs/1505.02563">https://arxiv.org/abs/1505.02563</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mgjeon\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>